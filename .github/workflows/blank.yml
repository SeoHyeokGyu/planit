name: Discord Issue Notifier

on:
  issues:
    types: [opened, closed, reopened, assigned, unassigned, labeled, unlabeled, edited, deleted, milestoned, demilestoned, locked, unlocked]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send Discord Notification
        env:
          WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK_URL }}
        run: |
          ACTION="${{ github.event.action }}"
          ISSUE_NUM="${{ github.event.issue.number }}"
          TITLE="${{ github.event.issue.title }}"
          URL="${{ github.event.issue.html_url }}"
          USER="${{ github.event.sender.login }}"
          REPO="${{ github.repository }}"
          
          # ì•¡ì…˜ë³„ ì´ëª¨ì§€ì™€ ìƒ‰ìƒ ì„¤ì •
          case $ACTION in
            "opened")
              EMOJI="ğŸš¨"
              MSG="ìƒˆ ì´ìŠˆ ìƒì„±"
              COLOR=15158332
              ;;
            "closed")
              EMOJI="âœ…"
              MSG="ì´ìŠˆ í•´ê²°"
              COLOR=3066993
              ;;
            "reopened")
              EMOJI="ğŸ”„"
              MSG="ì´ìŠˆ ì¬ê°œ"
              COLOR=15105570
              ;;
            "assigned")
              EMOJI="ğŸ‘¤"
              MSG="ë‹´ë‹¹ì ì§€ì •"
              ASSIGNEE="${{ github.event.assignee.login }}"
              COLOR=5763719
              ;;
            "unassigned")
              EMOJI="ğŸ‘¤"
              MSG="ë‹´ë‹¹ì í•´ì œ"
              COLOR=9807270
              ;;
            "labeled")
              LABEL="${{ github.event.label.name }}"
              EMOJI="ğŸ·ï¸"
              MSG="ë¼ë²¨ ì¶”ê°€: $LABEL"
              COLOR=3447003
              ;;
            "unlabeled")
              LABEL="${{ github.event.label.name }}"
              EMOJI="ğŸ·ï¸"
              MSG="ë¼ë²¨ ì œê±°: $LABEL"
              COLOR=10070709
              ;;
            "edited")
              EMOJI="âœï¸"
              MSG="ì´ìŠˆ ìˆ˜ì •"
              COLOR=16776960
              ;;
            "deleted")
              EMOJI="ğŸ—‘ï¸"
              MSG="ì´ìŠˆ ì‚­ì œ"
              COLOR=8421504
              ;;
            "milestoned")
              MILESTONE="${{ github.event.milestone.title }}"
              EMOJI="ğŸ¯"
              MSG="ë§ˆì¼ìŠ¤í†¤ ì„¤ì •: $MILESTONE"
              COLOR=5793266
              ;;
            "demilestoned")
              EMOJI="ğŸ¯"
              MSG="ë§ˆì¼ìŠ¤í†¤ í•´ì œ"
              COLOR=10070709
              ;;
            "locked")
              EMOJI="ğŸ”’"
              MSG="ì´ìŠˆ ì ê¸ˆ"
              COLOR=7506394
              ;;
            "unlocked")
              EMOJI="ğŸ”“"
              MSG="ì´ìŠˆ ì ê¸ˆ í•´ì œ"
              COLOR=1752220
              ;;
            *)
              EMOJI="ğŸ“Œ"
              MSG="ì´ìŠˆ ì—…ë°ì´íŠ¸"
              COLOR=3447003
              ;;
          esac
          
          echo "Sending notification: $MSG for issue #$ISSUE_NUM"
          
          # Discord ì „ì†¡
          curl -X POST "$WEBHOOK_URL" \
            -H "Content-Type: application/json" \
            -d "{
              \"username\": \"GitHub Issues\",
              \"avatar_url\": \"https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png\",
              \"embeds\": [{
                \"title\": \"$EMOJI $MSG #$ISSUE_NUM\",
                \"description\": \"**$TITLE**\",
                \"url\": \"$URL\",
                \"color\": $COLOR,
                \"fields\": [
                  {
                    \"name\": \"ğŸ“ ì €ì¥ì†Œ\",
                    \"value\": \"$REPO\",
                    \"inline\": true
                  },
                  {
                    \"name\": \"ğŸ‘¤ ì‘ì—…ì\",
                    \"value\": \"$USER\",
                    \"inline\": true
                  }
                ],
                \"timestamp\": \"$(date -u +%Y-%m-%dT%H:%M:%SZ)\"
              }]
            }"
          
          if [ $? -eq 0 ]; then
            echo "âœ… Notification sent successfully!"
          else
            echo "âŒ Failed to send notification"
            exit 1
          fi
